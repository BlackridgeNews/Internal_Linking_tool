<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Internal Linking Tool</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        .header h1 {
            color: #2d3748;
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header p {
            color: #666;
            font-size: 1.1rem;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            align-items: start;
        }

        .panel {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .panel h2 {
            color: #2d3748;
            font-size: 1.5rem;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e2e8f0;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            font-weight: 600;
            color: #4a5568;
            margin-bottom: 8px;
        }

        textarea {
            width: 100%;
            min-height: 400px;
            padding: 15px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 14px;
            line-height: 1.6;
            transition: border-color 0.3s ease;
            background: white;
            resize: vertical;
            font-family: 'Georgia', serif;
        }

        textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-right: 15px;
            margin-bottom: 15px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #718096, #4a5568);
        }

        .btn-success {
            background: linear-gradient(135deg, #48bb78, #38a169);
        }

        .btn-large {
            padding: 20px 40px;
            font-size: 18px;
            width: 100%;
            margin-bottom: 20px;
        }

        .control-buttons {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .status-message {
            margin: 15px 0;
            padding: 15px;
            border-radius: 10px;
            font-weight: 500;
            display: none;
        }

        .status-success {
            background: #c6f6d5;
            color: #22543d;
            border: 1px solid #9ae6b4;
        }

        .status-error {
            background: #fed7d7;
            color: #742a2a;
            border: 1px solid #feb2b2;
        }

        .status-info {
            background: #bee3f8;
            color: #2a4365;
            border: 1px solid #90cdf4;
        }

        .anchor-text-status {
            margin-bottom: 20px;
            padding: 15px;
            background: #f8fafc;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 14px;
            color: #4a5568;
            display: none;
        }

        .anchor-text-status.loaded {
            display: block;
            border-color: #48bb78;
            background: #f0fff4;
        }

        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .stat-item {
            background: #f7fafc;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            border: 1px solid #e2e8f0;
        }

        .stat-value {
            font-size: 24px;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 12px;
            color: #718096;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .output-container {
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            padding: 20px;
            min-height: 400px;
            max-height: 600px;
            overflow-y: auto;
            line-height: 1.7;
            font-family: 'Georgia', serif;
        }

        .output-container h1, .output-container h2, .output-container h3 {
            color: #2d3748;
            margin: 20px 0 10px 0;
            line-height: 1.3;
        }

        .output-container h2 {
            padding-bottom: 8px;
            border-bottom: 1px solid #e2e8f0;
        }

        .output-container a {
            color: #667eea;
            text-decoration: underline;
            transition: color 0.3s ease;
        }

        .output-container a:hover {
            color: #764ba2;
        }

        .output-container p {
            margin-bottom: 15px;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #718096;
        }

        .empty-state-icon {
            font-size: 48px;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 40px;
        }

        .spinner {
            border: 4px solid #e2e8f0;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .header h1 {
                font-size: 2rem;
            }

            .panel {
                padding: 20px;
            }

            .control-buttons {
                flex-direction: column;
            }

            .btn {
                margin-right: 0;
            }
        }

        .config-dialog {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 10000;
            display: none;
            justify-content: center;
            align-items: center;
        }

        .config-content {
            background: white;
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
        }

        .config-content h3 {
            margin-bottom: 20px;
            color: #2d3748;
        }

        .config-content input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 14px;
            margin-bottom: 15px;
        }

        .config-content small {
            color: #718096;
            font-size: 12px;
            display: block;
            margin-bottom: 15px;
        }

        .word-count {
            font-size: 12px;
            color: #718096;
            text-align: right;
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üîó Internal Linking Tool</h1>
            <p>Automatically add internal links to your content based on anchor text from Google Sheets</p>
        </div>

        <div class="main-content">
            <!-- Input Panel -->
            <div class="panel">
                <h2>üìù Input Content</h2>
                
                <div class="control-buttons">
                    <button class="btn btn-secondary" onclick="loadAnchorTexts()">
                        Load Anchor Texts
                    </button>
                    <button class="btn btn-secondary" onclick="showConfigDialog()">
                        Configure API
                    </button>
                    <button class="btn btn-secondary" onclick="clearAll()">
                        Clear All
                    </button>
                </div>

                <div class="anchor-text-status" id="anchorTextStatus">
                    <strong>üìä Anchor Texts:</strong> <span id="anchorTextCount">0</span> entries loaded
                    <div id="anchorTextDetails" style="margin-top: 8px; font-size: 12px; color: #718096;"></div>
                </div>

                <div class="status-message" id="statusMessage"></div>

                <div class="form-group">
                    <label for="inputContent">Paste your content here:</label>
                    <textarea 
                        id="inputContent" 
                        placeholder="Paste your article or content here. The tool will automatically find matching anchor texts and add internal links..."
                        oninput="updateWordCount()"
                    ></textarea>
                    <div class="word-count" id="wordCount">0 words, 0 characters</div>
                </div>

                <button class="btn btn-success btn-large" onclick="runInternalLinking()" id="runButton">
                    üöÄ Run Internal Linking
                </button>

                <div class="loading" id="loadingIndicator">
                    <div class="spinner"></div>
                    <p>Processing internal links...</p>
                </div>
            </div>

            <!-- Output Panel -->
            <div class="panel">
                <h2>‚ú® Output with Internal Links</h2>

                <div class="stats-container" id="statsContainer" style="display: none;">
                    <div class="stat-item">
                        <div class="stat-value" id="linksApplied">0</div>
                        <div class="stat-label">Links Added</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="wordsProcessed">0</div>
                        <div class="stat-label">Words</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="anchorTextsUsed">0</div>
                        <div class="stat-label">Anchors Used</div>
                    </div>
                </div>

                <div class="control-buttons">
                    <button class="btn btn-secondary" onclick="copyToClipboard()" id="copyButton" style="display: none;">
                        üìã Copy HTML
                    </button>
                    <button class="btn btn-secondary" onclick="downloadResult()" id="downloadButton" style="display: none;">
                        üíæ Download HTML
                    </button>
                </div>

                <div class="output-container" id="outputContainer">
                    <div class="empty-state">
                        <div class="empty-state-icon">üîó</div>
                        <p>Your content with internal links will appear here</p>
                        <small>Load anchor texts and paste content, then click "Run Internal Linking"</small>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Configuration Dialog -->
    <div class="config-dialog" id="configDialog">
        <div class="config-content">
            <h3>üîß Configure API Settings</h3>
            
            <label>Google Sheets API Key:</label>
            <input type="password" id="configApiKey" placeholder="Enter your Google Sheets API key">
            <small>Get your API key from Google Cloud Console ‚Üí APIs & Services ‚Üí Credentials</small>
            
            <label>Google Sheet ID:</label>
            <input type="text" id="configSheetId" placeholder="Enter Google Sheet ID">
            <small>The ID from your Google Sheet URL (between /spreadsheets/d/ and /edit)</small>
            
            <div style="text-align: right; margin-top: 20px;">
                <button class="btn btn-secondary" onclick="closeConfigDialog()">Cancel</button>
                <button class="btn" onclick="saveConfig()">Save Configuration</button>
            </div>
        </div>
    </div>

    <script>
        // Configuration
        const config = {
            googleSheetId: '1GT0kLFRtG8QTWgpW4O6bJh_rfgzmDWAiWbjp4hrXWA8',
            googleApiKey: ''
        };

        // Global variables
        let anchorTextData = [];
        let processedContent = '';
        let linkingStats = {
            linksApplied: 0,
            wordsProcessed: 0,
            anchorTextsUsed: 0
        };

        // Load anchor texts from Google Sheets
        async function loadAnchorTexts() {
            if (!config.googleApiKey) {
                showMessage('Please configure your Google API key first', 'error');
                showConfigDialog();
                return;
            }

            try {
                showMessage('Loading anchor texts from Google Sheet...', 'info');
                
                const response = await fetch(
                    `https://sheets.googleapis.com/v4/spreadsheets/${config.googleSheetId}/values/Sheet1!C:G?key=${config.googleApiKey}`
                );

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const data = await response.json();
                const rows = data.values || [];

                // Parse the data (skip header row if exists)
                anchorTextData = [];
                for (let i = 1; i < rows.length; i++) {
                    const row = rows[i];
                    if (row && row[0]) { // URL exists in column C (index 0)
                        const url = row[0];
                        const anchorTexts = [
                            row[1], // Column D
                            row[2], // Column E
                            row[3], // Column F
                            row[4]  // Column G
                        ].filter(text => text && text.trim()); // Remove empty entries

                        if (anchorTexts.length > 0) {
                            anchorTextData.push({
                                url: url,
                                anchorTexts: anchorTexts
                            });
                        }
                    }
                }

                showMessage(`‚úÖ Loaded ${anchorTextData.length} anchor text entries successfully!`, 'success');
                
                // Update UI to show anchor text status
                const statusElement = document.getElementById('anchorTextStatus');
                const countElement = document.getElementById('anchorTextCount');
                const detailsElement = document.getElementById('anchorTextDetails');
                
                if (statusElement && countElement && detailsElement) {
                    countElement.textContent = anchorTextData.length;
                    
                    // Calculate total anchor texts
                    const totalAnchors = anchorTextData.reduce((sum, item) => sum + item.anchorTexts.length, 0);
                    detailsElement.textContent = `${totalAnchors} total anchor phrases ‚Ä¢ ${anchorTextData.length} unique URLs`;
                    
                    statusElement.classList.add('loaded');
                }
                
                console.log('Loaded anchor text data:', anchorTextData);

            } catch (error) {
                console.error('Error loading anchor texts:', error);
                if (error.message.includes('403')) {
                    showMessage('Access denied. Please check your API key and ensure the Google Sheet is publicly accessible.', 'error');
                } else if (error.message.includes('404')) {
                    showMessage('Google Sheet not found. Please check the Sheet ID.', 'error');
                } else {
                    showMessage('Failed to load anchor texts: ' + error.message, 'error');
                }
            }
        }

        // Apply internal linking to content
        function runInternalLinking() {
            const inputContent = document.getElementById('inputContent').value.trim();
            
            if (!inputContent) {
                showMessage('Please paste some content to process', 'error');
                return;
            }

            if (!anchorTextData || anchorTextData.length === 0) {
                showMessage('Please load anchor texts first', 'error');
                return;
            }

            // Show loading
            document.getElementById('loadingIndicator').style.display = 'block';
            document.getElementById('runButton').disabled = true;

            // Process with slight delay for UI update
            setTimeout(() => {
                try {
                    const result = applyInternalLinks(inputContent);
                    displayResult(result);
                    showMessage(`‚úÖ Successfully applied ${linkingStats.linksApplied} internal links!`, 'success');
                } catch (error) {
                    console.error('Error applying internal links:', error);
                    showMessage('Error processing content: ' + error.message, 'error');
                } finally {
                    document.getElementById('loadingIndicator').style.display = 'none';
                    document.getElementById('runButton').disabled = false;
                }
            }, 100);
        }

        // Core internal linking function
        function applyInternalLinks(content) {
            let linkedContent = content;
            let linksApplied = 0;
            const usedAnchors = new Set();

            // Sort anchor texts by length (longest first) to avoid partial matches
            const allAnchors = [];
            anchorTextData.forEach(item => {
                item.anchorTexts.forEach(text => {
                    allAnchors.push({
                        text: text.trim(),
                        url: item.url
                    });
                });
            });

            // Sort by length descending to match longer phrases first
            allAnchors.sort((a, b) => b.text.length - a.text.length);

            // Track which parts of the text have already been linked
            const linkedPositions = new Set();

            allAnchors.forEach(anchor => {
                if (!anchor.text || anchor.text.length < 3) return; // Skip very short anchor texts
                if (linksApplied >= 15) return; // Limit total links

                // Create case-insensitive regex with word boundaries
                const escapedText = anchor.text.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
                const regex = new RegExp(`\\b${escapedText}\\b`, 'gi');

                const matches = [...linkedContent.matchAll(regex)];
                
                // Limit matches per anchor text to 2-3 to avoid over-linking
                const limitedMatches = matches.slice(0, 3);

                for (const match of limitedMatches) {
                    const startPos = match.index;
                    const endPos = startPos + match[0].length;

                    // Check if this position is already inside a link or HTML tag
                    const beforeMatch = linkedContent.substring(0, startPos);
                    const afterMatch = linkedContent.substring(endPos);
                    
                    // Skip if we're inside an HTML tag or already linked text
                    if (beforeMatch.lastIndexOf('<') > beforeMatch.lastIndexOf('>')) continue;
                    if (beforeMatch.includes('<a ') && !beforeMatch.includes('</a>')) continue;
                    if (linkedContent.substring(Math.max(0, startPos - 10), startPos).includes('<a ')) continue;

                    // Check for overlap with previously linked positions
                    let hasOverlap = false;
                    for (let i = startPos; i < endPos; i++) {
                        if (linkedPositions.has(i)) {
                            hasOverlap = true;
                            break;
                        }
                    }

                    if (!hasOverlap) {
                        // Mark positions as linked
                        for (let i = startPos; i < endPos; i++) {
                            linkedPositions.add(i);
                        }

                        // Apply the link
                        const linkedText = `<a href="${anchor.url}" target="_blank" style="color: #667eea; text-decoration: underline;">${match[0]}</a>`;
                        linkedContent = linkedContent.substring(0, startPos) + 
                                      linkedText + 
                                      linkedContent.substring(endPos);
                        
                        linksApplied++;
                        usedAnchors.add(anchor.text.toLowerCase());
                        
                        // Update positions for subsequent matches
                        const lengthDiff = linkedText.length - match[0].length;
                        const newLinkedPositions = new Set();
                        for (const pos of linkedPositions) {
                            if (pos < startPos) {
                                newLinkedPositions.add(pos);
                            } else if (pos >= endPos) {
                                newLinkedPositions.add(pos + lengthDiff);
                            } else {
                                newLinkedPositions.add(pos);
                            }
                        }
                        linkedPositions.clear();
                        newLinkedPositions.forEach(pos => linkedPositions.add(pos));
                        
                        // Break after successful link to avoid multiple replacements in same iteration
                        break;
                    }
                }
                
                if (linksApplied >= 15) return; // Stop if we've reached the limit
            });

            // Update stats
            linkingStats = {
                linksApplied: linksApplied,
                wordsProcessed: content.split(/\s+/).length,
                anchorTextsUsed: usedAnchors.size
            };

            console.log(`Applied ${linksApplied} internal links using ${usedAnchors.size} different anchor texts`);
            
            return linkedContent;
        }

        // Display the result
        function displayResult(content) {
            processedContent = content;
            const outputContainer = document.getElementById('outputContainer');
            
            // Format content for display (convert line breaks to paragraphs if needed)
            let formattedContent = content;
            if (!content.includes('<p>') && !content.includes('<h1>') && !content.includes('<h2>')) {
                // Simple text - convert line breaks to paragraphs
                formattedContent = content
                    .split('\n\n')
                    .map(paragraph => paragraph.trim())
                    .filter(paragraph => paragraph.length > 0)
                    .map(paragraph => `<p>${paragraph.replace(/\n/g, '<br>')}</p>`)
                    .join('\n');
            }
            
            outputContainer.innerHTML = formattedContent;
            
            // Update stats
            document.getElementById('linksApplied').textContent = linkingStats.linksApplied;
            document.getElementById('wordsProcessed').textContent = linkingStats.wordsProcessed.toLocaleString();
            document.getElementById('anchorTextsUsed').textContent = linkingStats.anchorTextsUsed;
            
            // Show stats and action buttons
            document.getElementById('statsContainer').style.display = 'grid';
            document.getElementById('copyButton').style.display = 'inline-block';
            document.getElementById('downloadButton').style.display = 'inline-block';
        }

        // Copy result to clipboard
        async function copyToClipboard() {
            if (!processedContent) return;

            try {
                await navigator.clipboard.writeText(processedContent);
                showMessage('‚úÖ Content copied to clipboard!', 'success');
            } catch (error) {
                console.error('Failed to copy:', error);
                // Fallback method
                const textArea = document.createElement('textarea');
                textArea.value = processedContent;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                showMessage('‚úÖ Content copied to clipboard!', 'success');
            }
        }

        // Download result as HTML file
        function downloadResult() {
            if (!processedContent) return;

            const htmlContent = `<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Content with Internal Links</title>
    <style>
        body { font-family: Georgia, serif; line-height: 1.6; max-width: 800px; margin: 0 auto; padding: 20px; }
        a { color: #667eea; text-decoration: underline; }
        a:hover { color: #764ba2; }
        h1, h2, h3 { color: #2d3748; }
        p { margin-bottom: 15px; }
    </style>
</head>
<body>
${processedContent}
</body>
</html>`;

            const blob = new Blob([htmlContent], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `content_with_internal_links_${new Date().toISOString().slice(0,10)}.html`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);

            showMessage('‚úÖ HTML file downloaded!', 'success');
        }

        // Update word count
        function updateWordCount() {
            const content = document.getElementById('inputContent').value;
            const words = content.trim() ? content.trim().split(/\s+/).length : 0;
            const chars = content.length;
            document.getElementById('wordCount').textContent = `${words.toLocaleString()} words, ${chars.toLocaleString()} characters`;
        }

        // Clear all content
        function clearAll() {
            if (confirm('Are you sure you want to clear all content?')) {
                document.getElementById('inputContent').value = '';
                document.getElementById('outputContainer').innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">üîó</div>
                        <p>Your content with internal links will appear here</p>
                        <small>Load anchor texts and paste content, then click "Run Internal Linking"</small>
                    </div>
                `;
                document.getElementById('statsContainer').style.display = 'none';
                document.getElementById('copyButton').style.display = 'none';
                document.getElementById('downloadButton').style.display = 'none';
                processedContent = '';
                updateWordCount();
                showMessage('All content cleared', 'info');
            }
        }

        // Configuration management
        function showConfigDialog() {
            document.getElementById('configApiKey').value = config.googleApiKey;
            document.getElementById('configSheetId').value = config.googleSheetId;
            document.getElementById('configDialog').style.display = 'flex';
        }

        function closeConfigDialog() {
            document.getElementById('configDialog').style.display = 'none';
        }

        function saveConfig() {
            const apiKey = document.getElementById('configApiKey').value.trim();
            const sheetId = document.getElementById('configSheetId').value.trim();

            if (apiKey) config.googleApiKey = apiKey;
            if (sheetId) config.googleSheetId = sheetId;

            localStorage.setItem('internalLinking_config', JSON.stringify(config));

            closeConfigDialog();
            showMessage('‚úÖ Configuration saved successfully!', 'success');
        }

        // Load config from localStorage
        function loadConfig() {
            try {
                const savedConfig = localStorage.getItem('internalLinking_config');
                if (savedConfig) {
                    Object.assign(config, JSON.parse(savedConfig));
                }
            } catch (error) {
                console.warn('Could not load config:', error);
            }
        }

        // Show messages
        function showMessage(message, type) {
            const statusElement = document.getElementById('statusMessage');
            statusElement.textContent = message;
            statusElement.className = `status-message status-${type}`;
            statusElement.style.display = 'block';

            setTimeout(() => {
                statusElement.style.display = 'none';
            }, 5000);
        }

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            loadConfig();
            updateWordCount();
            
            // Auto-load anchor texts if API key is configured
            if (config.googleApiKey) {
                loadAnchorTexts();
            }

            // Add keyboard shortcuts
            document.addEventListener('keydown', function(e) {
                // Ctrl/Cmd + Enter to run internal linking
                if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {
                    e.preventDefault();
                    runInternalLinking();
                }
                
                // Ctrl/Cmd + Shift + C to copy result
                if ((e.ctrlKey || e.metaKey) && e.shiftKey && e.key === 'C') {
                    e.preventDefault();
                    if (processedContent) {
                        copyToClipboard();
                    }
                }
            });

            // Add sample content button for demo
            addSampleContentFeature();
        });

        // Add sample content feature for demonstration
        function addSampleContentFeature() {
            const sampleButton = document.createElement('button');
            sampleButton.className = 'btn btn-secondary';
            sampleButton.textContent = 'üìÑ Load Sample Content';
            sampleButton.onclick = loadSampleContent;
            
            const controlButtons = document.querySelector('.control-buttons');
            controlButtons.appendChild(sampleButton);
        }

        // Load sample content for testing
        function loadSampleContent() {
            const sampleContent = `The Future of Renewable Energy Infrastructure

The global transition to renewable energy is accelerating at an unprecedented pace, driven by technological advances and growing environmental concerns. Solar power installations have increased dramatically over the past decade, with photovoltaic technology becoming more efficient and cost-effective.

Wind energy projects are expanding across multiple continents, particularly in offshore locations where consistent wind patterns provide reliable power generation. These developments are supported by substantial infrastructure investments and government incentives designed to promote clean energy adoption.

Market research indicates that the renewable energy sector will continue to grow substantially through 2030. Industry analysts predict that solar and wind technologies will account for the majority of new power generation capacity in developed nations.

The integration of battery storage systems with renewable installations is solving the intermittency challenge that has historically limited clean energy deployment. Advanced grid management systems are also being developed to handle the variable nature of renewable power sources.

Electric vehicle adoption is creating additional demand for clean electricity, further driving investment in renewable infrastructure. Charging networks are expanding rapidly to support the growing fleet of electric cars and trucks.

Carbon capture and storage technologies are being developed to complement renewable energy systems, particularly in industrial applications where direct electrification may not be feasible. These technologies could play a crucial role in achieving net-zero emissions targets.

The semiconductor industry is also contributing to the renewable energy transition by developing more efficient power conversion systems and smart grid technologies. Advanced materials and manufacturing processes are reducing the cost and improving the performance of renewable energy components.`;

            document.getElementById('inputContent').value = sampleContent;
            updateWordCount();
            showMessage('üìÑ Sample content loaded! You can now run internal linking to see how it works.', 'info');
        }

        // Add helpful tooltips and keyboard shortcuts display
        function showKeyboardShortcuts() {
            const shortcutsHtml = `
                <div style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
                           background: rgba(0,0,0,0.5); z-index: 10000; display: flex; 
                           justify-content: center; align-items: center;">
                    <div style="background: white; padding: 30px; border-radius: 15px; 
                               width: 90%; max-width: 400px; box-shadow: 0 20px 40px rgba(0,0,0,0.3);">
                        <h3 style="margin-bottom: 20px; color: #2d3748;">‚å®Ô∏è Keyboard Shortcuts</h3>
                        
                        <div style="margin-bottom: 15px;">
                            <strong>Ctrl/Cmd + Enter:</strong> Run Internal Linking
                        </div>
                        <div style="margin-bottom: 15px;">
                            <strong>Ctrl/Cmd + Shift + C:</strong> Copy Result to Clipboard
                        </div>
                        <div style="margin-bottom: 20px;">
                            <strong>Escape:</strong> Close Dialogs
                        </div>
                        
                        <div style="text-align: right;">
                            <button onclick="this.closest('div').parentElement.remove()" 
                                    style="background: #667eea; color: white; border: none; 
                                           padding: 10px 20px; border-radius: 8px; cursor: pointer;">
                                Got it!
                            </button>
                        </div>
                    </div>
                </div>
            `;

            document.body.insertAdjacentHTML('beforeend', shortcutsHtml);
        }

        // Add keyboard shortcuts info to header
        setTimeout(() => {
            const header = document.querySelector('.header p');
            header.innerHTML += '<br><small style="color: #888; font-size: 0.9rem;">üí° Press Ctrl+Enter to run linking ‚Ä¢ <a href="#" onclick="showKeyboardShortcuts(); return false;" style="color: #667eea;">View all shortcuts</a></small>';
        }, 1000);

        // Add escape key handling for dialogs
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                // Close config dialog if open
                const configDialog = document.getElementById('configDialog');
                if (configDialog.style.display === 'flex') {
                    closeConfigDialog();
                }
                
                // Close any other open dialogs
                const openDialogs = document.querySelectorAll('div[style*="position: fixed"]');
                openDialogs.forEach(dialog => {
                    if (dialog.style.display !== 'none') {
                        dialog.remove();
                    }
                });
            }
        });
